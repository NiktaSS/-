
## ‚úÖ 1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π SQLAlchemy

**–ß—Ç–æ —ç—Ç–æ:**  
SQLAlchemy —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `async/await` –ø–æ—è–≤–∏–ª—Å—è —Å –≤–µ—Ä—Å–∏–∏ 1.4+ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- `asyncpg` ‚Äî –¥–ª—è PostgreSQL
- `aiomysql` ‚Äî –¥–ª—è MySQL

### üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `async_engine`, `async_session`
- –ó–∞–ø—Ä–æ—Å—ã –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ `async with`
- –í—Å–µ –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `await`

---

### üîß –ü—Ä–∏–º–µ—Ä —Å PostgreSQL –∏ `asyncpg`:

```python
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import declarative_base, sessionmaker
from sqlalchemy import Column, Integer, String, select

Base = declarative_base()

class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True)
    name = Column(String)

# –°–æ–∑–¥–∞—ë–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫
engine = create_async_engine("postgresql+asyncpg://user:pass@localhost/db")

# –°–µ—Å—Å–∏—è
async_session = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)

async def get_users():
    async with async_session() as session:
        result = await session.execute(select(User))
        return result.scalars().all()
```

### ‚ùó –í–∞–∂–Ω–æ:

- –í–º–µ—Å—Ç–æ `create_engine` ‚Üí `create_async_engine`
- –í–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–π `Session` ‚Üí `AsyncSession`
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã: `await session.execute(...)`

---

## ‚úÖ 2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `requests`

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `requests` –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ ‚Äî —ç—Ç–æ **–Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ –¥–ª—è async-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**.  
–ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- [`httpx`](https://www.python-httpx.org/)
- `aiohttp`

---

### üîß –ü—Ä–∏–º–µ—Ä —Å `httpx`:

```python
import httpx
import asyncio

async def fetch_data():
    async with httpx.AsyncClient() as client:
        response = await client.get("https://httpbin.org/get")
        print(response.json())

asyncio.run(fetch_data())
```

---

## üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö HTTP-–∫–ª–∏–µ–Ω—Ç–æ–≤:

|-|`requests`|`httpx` / `aiohttp`|
|---|---|---|
|–¢–∏–ø|–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (–±–ª–æ–∫–∏—Ä—É—é—â–∏–π)|–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (`async/await`)|
|–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ|–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤|–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è async-—Å–µ—Ä–≤–µ—Ä–æ–≤|
|HTTP2|‚ùå|‚úÖ (`httpx` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)|
 
---

## üìù –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> ¬´–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π SQLAlchemy —Ä–∞–±–æ—Ç–∞–µ—Ç —Å async-–¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `async_session`, `await session.execute(...)`. –î–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `httpx` –∏–ª–∏ `aiohttp`, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç `async with` –∏ `await`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ I/O –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ¬ª.

## ‚ö° –ü—Ä–∏–º–µ—Ä 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `requests` (sync) vs `httpx` (async)

–î–æ–ø—É—Å—Ç–∏–º, –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å **10 HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤** –∫ –∫–∞–∫–æ–º—É-–Ω–∏–±—É–¥—å –ø—Ä–æ—Å—Ç–æ–º—É API, –Ω–∞–ø—Ä–∏–º–µ—Ä, `https://httpbin.org/delay/1`, –∫–æ—Ç–æ—Ä–æ–µ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É 1 —Å–µ–∫.

---

### üêå –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `requests`:

```python
import requests
import time

def fetch():
    for _ in range(10):
        r = requests.get("https://httpbin.org/delay/1")
        print(r.status_code)

start = time.time()
fetch()
print(f"–í—Ä–µ–º—è: {time.time() - start:.2f} —Å–µ–∫")
```

‚è±Ô∏è –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∂–¥—ë—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π ‚Üí ~10 —Å–µ–∫—É–Ω–¥ –Ω–∞ 10 –∑–∞–ø—Ä–æ—Å–æ–≤

---

### ‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `httpx`:

```python
import httpx
import asyncio
import time

async def fetch(client):
    r = await client.get("https://httpbin.org/delay/1")
    print(r.status_code)

async def main():
    async with httpx.AsyncClient() as client:
        tasks = [fetch(client) for _ in range(10)]
        await asyncio.gather(*tasks)

start = time.time()
asyncio.run(main())
print(f"–í—Ä–µ–º—è: {time.time() - start:.2f} —Å–µ–∫")
```

‚è±Ô∏è –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ ‚Üí ~1.1 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ 10 –∑–∞–ø—Ä–æ—Å–æ–≤

---

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:

|–¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞|–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è|
|---|---|
|`requests`|~10 —Å–µ–∫—É–Ω–¥|
|`httpx` async|~1‚Äì1.2 —Å–µ–∫—É–Ω–¥—ã|

üìå –†–∞–∑–Ω–∏—Ü–∞ **–≤ 10 —Ä–∞–∑** –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤!

---

## üõ¢Ô∏è –ü—Ä–∏–º–µ—Ä 2: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ë–î (`asyncpg` / SQLAlchemy)

–î–æ–ø—É—Å—Ç–∏–º, —Ç–µ–±–µ –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç—å 100 —Å—Ç—Ä–æ–∫ –∏–∑ –ë–î. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

- –æ–±—ã—á–Ω—ã–π `psycopg2` –∏–ª–∏ `sqlite3` ‚Üí –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å **–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫**
    
- `asyncpg` —Å `asyncio.gather()` ‚Üí –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**
    

–†–∞–∑–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –∑–∞–º–µ—Ç–Ω–∞ –ø—Ä–∏ **–±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**:

- sync –ø–æ–¥—Ö–æ–¥ = –≤—Å—ë –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
    
- async –ø–æ–¥—Ö–æ–¥ = –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–∞–∫ FastAPI + PostgreSQL)
    

---

## üìù –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> ¬´–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –ø–æ—Ç–æ–∫: –∫–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ. –í –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `httpx`, `asyncpg`, `async SQLAlchemy`) –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç event loop. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–µ—Å—è—Ç–∫–∏ –∏–ª–∏ —Å–æ—Ç–Ω–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤¬ª.
