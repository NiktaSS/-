
–ß—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å CSRF, –Ω—É–∂–Ω–æ **—Ä–∞–∑–æ—Ä–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –µ–≥–æ —É—á–∞—Å—Ç–∏—è**. –í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã.

---

### üîê 1. CSRF-—Ç–æ–∫–µ–Ω (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–±)

**–ß—Ç–æ —ç—Ç–æ:**  
–°–µ—Ä–≤–µ—Ä –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–æ—Ä–º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω**, –∏ —Ç—Ä–µ–±—É–µ—Ç –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã.  
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç —É–≥–∞–¥–∞—Ç—å —Ç–æ–∫–µ–Ω ‚Üí –∑–∞–ø—Ä–æ—Å –Ω–µ –ø—Ä–æ–π–¥—ë—Ç.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ HTML-—Ñ–æ—Ä–º—É.
    
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∑–∞–ø—Ä–æ—Å–æ–º.
    
- –°–µ—Ä–≤–µ—Ä —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç: –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ —Å–æ–≤–ø–∞–ª ‚Äî –æ—Ç–∫–ª–æ–Ω—è–µ—Ç.
    

**‚úÖ –ü—Ä–∏–º–µ—Ä Django (–≤—Å—Ç—Ä–æ–µ–Ω–æ):**

```html
<form method="POST">
  {% csrf_token %}
  <input name="email">
</form>
```

üìå Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ `POST`, `PUT`, `DELETE`.

**‚úÖ –ü—Ä–∏–º–µ—Ä Flask —Å Flask-WTF:**

```python
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField

class EmailForm(FlaskForm):
    email = StringField()
    submit = SubmitField("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å")
```

```html
<form method="POST">
  {{ form.csrf_token }}
  {{ form.email }}
  {{ form.submit }}
</form>
```

---

### üè∑ 2. SameSite cookie (–±—Ä–∞—É–∑–µ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)

**–ß—Ç–æ —ç—Ç–æ:**  
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ –≤ –∫—É–∫–µ, –∫–æ—Ç–æ—Ä—ã–π **–∑–∞–ø—Ä–µ—â–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –∫—É–∫–∏** –ø—Ä–∏ –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**

|–ó–Ω–∞—á–µ–Ω–∏–µ|–ü–æ–≤–µ–¥–µ–Ω–∏–µ|
|---|---|
|`Strict`|–ö—É–∫–∞ **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–æ–æ–±—â–µ** –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —Å –¥—Ä—É–≥–æ–≥–æ —Å–∞–π—Ç–∞|
|`Lax`|–ö—É–∫–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –¥–ª—è `POST` –∏ `iframe`, –Ω–æ –º–æ–∂–Ω–æ –¥–ª—è `GET`|
|`None`|–ö—É–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `Secure=true`)|

**‚úÖ –ü—Ä–∏–º–µ—Ä:**

```python
resp.set_cookie("sessionid", "abc123", samesite='Strict', secure=True)
```

---

### üïµÔ∏è 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ `Origin` –∏ `Referer`

**–ß—Ç–æ —ç—Ç–æ:**  
–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, **–æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à—ë–ª –∑–∞–ø—Ä–æ—Å** ‚Äî –æ—Ç —Å–∞–π—Ç–∞ –∏–ª–∏ —á—É–∂–æ–≥–æ –¥–æ–º–µ–Ω–∞.

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ Flask:**

```python
from flask import request, abort

@app.before_request
def check_origin():
    if request.method == "POST":
        origin = request.headers.get("Origin")
        if origin != "http://localhost:5000":
            abort(403)
```

---

### ‚õî 4. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—É–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`**, –Ω–∞–ø—Ä–∏–º–µ—Ä `Bearer`.

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:

- –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç `Authorization` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- –ê—Ç–∞–∫–∞ CSRF **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞**, –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω —è–≤–Ω–æ –Ω–µ –∑–∞–¥–∞–Ω JavaScript'–æ–º ‚Üí –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø.

üìå –û–¥–Ω–∞–∫–æ —Ç–æ–∫–µ–Ω—ã –Ω—É–∂–Ω–æ **—Ö—Ä–∞–Ω–∏—Ç—å –≤ `localStorage` –∏–ª–∏ `sessionStorage`**, —á—Ç–æ –Ω–µ—Å—ë—Ç –¥—Ä—É–≥–∏–µ —Ä–∏—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, XSS).

---

## üß† –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> ¬´–û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –∑–∞—â–∏—Ç—ã ‚Äî **CSRF-—Ç–æ–∫–µ–Ω—ã**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **SameSite cookies** –∏–ª–∏ **–ø—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ Origin/Referer**. –í API —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö ‚Äî –æ–Ω–∏ –Ω–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã CSRF¬ª.
