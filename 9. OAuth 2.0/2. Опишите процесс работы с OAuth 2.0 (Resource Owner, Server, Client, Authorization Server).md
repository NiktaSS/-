## üß© –£—á–∞—Å—Ç–Ω–∏–∫–∏ (—Ä–æ–ª–∏ –≤ OAuth 2.0)

|–†–æ–ª—å|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|**Resource Owner**|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–Ω–Ω—ã—Ö)|
|**Client**|–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—á–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∞—à —Å–∞–π—Ç)|
|**Resource Server**|API, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google Drive API)|
|**Authorization Server**|–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ —Ç–æ–∂–µ —É Google, GitHub –∏ —Ç.–ø.) ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–¥–∞—ë—Ç —Ç–æ–∫–µ–Ω—ã|

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å (Authorization Code Flow ‚Äì –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π)

### üí° –¶–µ–ª—å: –ø–æ–ª—É—á–∏—Ç—å `access_token`, —á—Ç–æ–±—ã –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 1: üîó –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

–ö–ª–∏–µ–Ω—Ç (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ `Authorization Server`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```http
GET https://auth.server.com/auth?response_type=code&
    client_id=client123&
    redirect_uri=https://myapp.com/callback&
    scope=email
```

‚û°Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è, —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø.

---

### –®–∞–≥ 2: üéüÔ∏è –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

Authorization Server –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–∞–π—Ç –∫–ª–∏–µ–Ω—Ç–∞:

```
https://myapp.com/callback?code=abc123
```

---

### –®–∞–≥ 3: üîë –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST`-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –æ–±–º–µ–Ω—è—Ç—å `code` –Ω–∞ —Ç–æ–∫–µ–Ω:

```http
POST https://auth.server.com/token
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&code=abc123
&redirect_uri=https://myapp.com/callback
&client_id=client123
&client_secret=secret456
```

üîÅ –í –æ—Ç–≤–µ—Ç:

```json
{
  "access_token": "xyz789",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "refresh_abc"
}
```

---

### –®–∞–≥ 4: üì¶ –î–æ—Å—Ç—É–ø –∫ API

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `access_token` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤:

```http
GET https://api.server.com/userinfo
Authorization: Bearer xyz789
```

---

## üß† –ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å

- OAuth 2.0 **–Ω–µ –ª–æ–≥–∏–Ω–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**, –∞ –¥–∞—ë—Ç **–¥–æ—Å—Ç—É–ø –∫ –µ–≥–æ —Ä–µ—Å—É—Ä—Å–∞–º** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∞–π–ª–∞–º, e-mail –∏ —Ç.–ø.).
    
- –¢–æ–∫–µ–Ω –≤—ã–¥–∞—ë—Ç—Å—è **–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**, –∞ **–∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é**, –Ω–æ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
- `access_token` ‚Äî –∫—Ä–∞—Ç–∫–æ–∂–∏–≤—É—â–∏–π, `refresh_token` ‚Äî –¥–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è.
    

---

## üìù –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> OAuth 2.0 ‚Äî —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º —É—á–∞—Å—Ç–≤—É—é—Ç –∫–ª–∏–µ–Ω—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–µ—Ä–≤–µ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –¥–æ—Å—Ç—É–ø, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥, –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç –µ–≥–æ –Ω–∞ —Ç–æ–∫–µ–Ω, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.


OAuth 2.0 –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–≤–æ–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é **–ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ GitHub**, –±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è –µ–≥–æ –ø–∞—Ä–æ–ª—è. –í—Å—ë, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ ‚Äî —ç—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ GitHub –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º "–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ç—Ä–µ—Ç–∏–π —Å–µ—Ä–≤–∏—Å".

---

## üì¶ –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å OAuth-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ GitHub  
    –ü–µ—Ä–µ–π–¥–∏ –≤: [https://github.com/settings/developers](https://github.com/settings/developers) ‚Üí **OAuth Apps ‚Üí New OAuth App**
    
    –£–∫–∞–∂–∏:
    
    - **Homepage URL:** `http://localhost:5000`
        
    - **Callback URL:** `http://localhost:5000/callback`
        
2. –ü–æ–ª—É—á–∏ `Client ID` –∏ `Client Secret`
    

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install flask requests
```

---

## üß™ –ü—Ä–∏–º–µ—Ä –Ω–∞ Flask

```python
from flask import Flask, redirect, request, session, url_for
import requests

app = Flask(__name__)
app.secret_key = 'your_secret_key'  # –ù—É–∂–µ–Ω –¥–ª—è session

# üîê –î–∞–Ω–Ω—ã–µ GitHub-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
CLIENT_ID = '–í–ê–®_CLIENT_ID'
CLIENT_SECRET = '–í–ê–®_CLIENT_SECRET'
AUTH_URL = 'https://github.com/login/oauth/authorize'
TOKEN_URL = 'https://github.com/login/oauth/access_token'
USER_API_URL = 'https://api.github.com/user'


@app.route('/')
def index():
    if 'user' in session:
        return f"–ü—Ä–∏–≤–µ—Ç, {session['user']['login']}!"
    return '<a href="/login">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ GitHub</a>'


@app.route('/login')
def login():
    # –†–µ–¥–∏—Ä–µ–∫—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ GitHub –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    return redirect(f"{AUTH_URL}?client_id={CLIENT_ID}&scope=read:user")


@app.route('/callback')
def callback():
    # GitHub –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Å—é–¥–∞ —Å ?code=...
    code = request.args.get('code')

    # –û–±–º–µ–Ω–∏–≤–∞–µ–º code –Ω–∞ access_token
    token_response = requests.post(
        TOKEN_URL,
        headers={'Accept': 'application/json'},
        data={
            'client_id': CLIENT_ID,
            'client_secret': CLIENT_SECRET,
            'code': code
        }
    )
    token_json = token_response.json()
    access_token = token_json.get('access_token')

    if not access_token:
        return '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞.'

    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    user_response = requests.get(
        USER_API_URL,
        headers={'Authorization': f'token {access_token}'}
    )
    user_data = user_response.json()

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–µ—Å—Å–∏–∏
    session['user'] = user_data
    return redirect(url_for('index'))


@app.route('/logout')
def logout():
    session.clear()
    return redirect(url_for('index'))


if __name__ == '__main__':
    app.run(debug=True)
```

---

## üí° –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—à–∞–≥–æ–≤–æ:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ GitHub"
    
2. –ú—ã —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏–º –µ–≥–æ –Ω–∞ GitHub `https://github.com/login/oauth/authorize`
    
3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ GitHub –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ `/callback?code=...`
    
4. Flask –ø–æ–ª—É—á–∞–µ—Ç `code` –∏ –¥–µ–ª–∞–µ—Ç `POST` –Ω–∞ `https://github.com/login/oauth/access_token` —Å `client_id`, `client_secret`, `code`
    
5. –ü–æ–ª—É—á–∞–µ–º `access_token`
    
6. –° —ç—Ç–∏–º —Ç–æ–∫–µ–Ω–æ–º –¥–µ–ª–∞–µ–º `GET https://api.github.com/user`
    
7. –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `session`
    

---

## üìù –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> –í OAuth 2.0 GitHub –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ Authorization Server. –ú—ã –Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ GitHub –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø–æ–ª—É—á–∞–µ–º –æ—Ç—Ç—É–¥–∞ –∫–æ–¥, –æ–±–º–µ–Ω–∏–≤–∞–µ–º –µ–≥–æ –Ω–∞ access_token –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —á–µ—Ä–µ–∑ GitHub API. –í Flask –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É—è `requests` –∏ `session`.
