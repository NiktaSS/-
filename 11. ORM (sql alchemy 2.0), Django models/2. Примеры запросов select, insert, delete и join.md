## üîπ SQLAlchemy 2.0 (ORM —Å –º–æ–¥–µ–ª—è–º–∏)

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É —Ç–µ–±—è –µ—Å—Ç—å —Ç–∞–∫–∏–µ –º–æ–¥–µ–ª–∏:

```python
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column, relationship
from sqlalchemy import ForeignKey
from typing import List

class Base(DeclarativeBase):
    pass

class User(Base):
    __tablename__ = "users"

    id: Mapped[int] = mapped_column(primary_key=True)
    name: Mapped[str]
    posts: Mapped[List["Post"]] = relationship(back_populates="user")

class Post(Base):
    __tablename__ = "posts"

    id: Mapped[int] = mapped_column(primary_key=True)
    title: Mapped[str]
    user_id: Mapped[int] = mapped_column(ForeignKey("users.id"))
    user: Mapped["User"] = relationship(back_populates="posts")
```

## üìå SQL (—á–∏—Å—Ç—ã–π —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤)

```sql
-- –¢–∞–±–ª–∏—Ü—ã:
-- users(id, name)
-- posts(id, title, user_id)

-- SELECT: –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã
SELECT * FROM posts;

-- INSERT: –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
INSERT INTO users (name) VALUES ('Alice');

-- DELETE: —É–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç —Å id = 5
DELETE FROM posts WHERE id = 5;

-- JOIN: –ø–æ—Å—Ç—ã –≤–º–µ—Å—Ç–µ —Å –∞–≤—Ç–æ—Ä–∞–º–∏
SELECT posts.title, users.name
FROM posts
JOIN users ON posts.user_id = users.id;
```

---

## üêç SQLAlchemy 2.0 (declarative + Core-style)

```python
from sqlalchemy import select, insert, delete, join
from models import users, posts  # —Ç–∞–±–ª–∏—Ü—ã –æ–ø–∏—Å–∞–Ω—ã —á–µ—Ä–µ–∑ Table(...)

# SELECT
stmt = select(posts)
results = conn.execute(stmt).fetchall()

# INSERT
stmt = insert(users).values(name="Alice")
conn.execute(stmt)

# DELETE
stmt = delete(posts).where(posts.c.id == 5)
conn.execute(stmt)

# JOIN
stmt = select(posts.c.title, users.c.name).join(users, posts.c.user_id == users.c.id)
conn.execute(stmt).fetchall()
```

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å ORM-–∫–ª–∞—Å—Å—ã (`User`, `Post`) ‚Äî –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ —Å–µ—Å—Å–∏–∏ –∏ `Session.execute()`.


### ‚úÖ SELECT

```python
stmt = select(User).where(User.name == "Alice")
result = session.execute(stmt).scalar_one()
```

### ‚úÖ INSERT

```python
new_user = User(name="Alice")
session.add(new_user)
session.commit()
```

### ‚úÖ DELETE

```python
user = session.get(User, 1)
session.delete(user)
session.commit()
```

### ‚úÖ JOIN (—á–µ—Ä–µ–∑ relationship)

```python
stmt = select(Post).join(Post.user).where(User.name == "Alice")
posts = session.execute(stmt).scalars().all()

for post in posts:
    print(post.title, post.user.name)
```


---

## üåê Django ORM

```python
# SELECT
Post.objects.all()

# INSERT
User.objects.create(name="Alice")

# DELETE
Post.objects.filter(id=5).delete()

# JOIN (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ ForeignKey)
Post.objects.select_related('user').all()
# –∏–ª–∏
for post in Post.objects.select_related('user'):
    print(post.title, post.user.name)
```

---

## üß† –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> SQL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ SELECT, INSERT, DELETE, JOIN. –í ORM (–Ω–∞–ø—Ä–∏–º–µ—Ä, SQLAlchemy –∏–ª–∏ Django) —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –º–µ—Ç–æ–¥—ã –∏ –∫–ª–∞—Å—Å—ã, –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É—é—â–∏–µ —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω—è—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—é.


## üß† –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ:

> –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è ORM-–º–æ–¥–µ–ª–∏, —Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ SELECT, INSERT, DELETE, JOIN –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–æ–≤. SQLAlchemy –∏ Django ORM –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ Python –≤–º–µ—Å—Ç–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞–ø—Ä—è–º—É—é, –∞ JOIN —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–≤—è–∑–∏ (`relationship` –∏–ª–∏ `ForeignKey`).
